<!-- Bannière hero avec titre de catégorie -->
<section class="category-hero">
  @if (artwork$ | async; as artwork) {
    <div class="hero-content">
      <h1>LES OEUVRES</h1>
      @if (primaryCategory$ | async; as category) {
        <div class="category-title">{{ category.name }}</div>
      }
    </div>
  }
</section>

<!-- Section principale avec détail de l'œuvre -->
@if (artwork$ | async; as artwork) {
  <section class="artwork-detail-section">
    <div class="container">
      <div class="section-header">
        <h2>— {{ artwork.title }}</h2>
      </div>

      <div class="artwork-content">
        <!-- Galerie d'images -->
        <div class="artwork-gallery">
          <div class="main-image-container">
            <!-- Flèches de navigation principale -->
            @if (artwork.imageUrls && artwork.imageUrls.length > 1) {
              <button class="main-carousel-btn prev" (click)="previousImage()" [disabled]="selectedImageIndex() === 0">
                <mat-icon>chevron_left</mat-icon>
              </button>
              <button class="main-carousel-btn next" (click)="nextImage()" [disabled]="selectedImageIndex() === artwork.imageUrls.length - 1">
                <mat-icon>chevron_right</mat-icon>
              </button>
            }

            <div class="main-image">
              <img
                [src]="artwork.imageUrls && artwork.imageUrls.length > 0 ? artwork.imageUrls[selectedImageIndex()] : artwork.mainImageUrl"
                [alt]="artwork.title"
                class="main-artwork-image"
                (click)="openImageModal(selectedImageIndex())">
            </div>
          </div>

          @if (artwork.imageUrls && artwork.imageUrls.length > 1) {
            <div class="thumbnail-carousel">
              <button class="carousel-btn prev" (click)="scrollThumbnails('left')">
                <mat-icon>chevron_left</mat-icon>
              </button>

              <div class="thumbnails-container" #thumbnailsContainer>
                @for (imageUrl of artwork.imageUrls; track $index) {
                  <div
                    class="thumbnail"
                    [class.active]="selectedImageIndex() === $index"
                    (click)="selectImage($index)">
                    <img [src]="imageUrl" [alt]="artwork.title">
                  </div>
                }
              </div>

              <button class="carousel-btn next" (click)="scrollThumbnails('right')">
                <mat-icon>chevron_right</mat-icon>
              </button>
            </div>
          }
        </div>

        <!-- Informations de l'œuvre -->
        <div class="artwork-info">
          <h3 class="artwork-title">{{ artwork.title }}</h3>

          <div class="artwork-meta">
            <p><strong>Mois, Année</strong></p>
          </div>

          <div class="artwork-description">
            <p>Debut du paragraphe PDP oeuvre Lorem ipsum dolor sit amet, ipsum labitur lucilius mei id, ad has appareat. Debut du paragraphe PDP oeuvre Lorem ipsum dolor sit amet, ipsum labitur lucilius mei id, ad has appareat.Debut du paragraphe PDP oeuvre Lorem ipsum dolor sit amet, ipsum labitur lucilius mei id, ad has appareat.</p>

            <p>Debut du paragraphe PDP oeuvre Lorem ipsum dolor sit amet, ipsum labitur lucilius mei id, ad has appareat. Debut du paragraphe PDP oeuvre Lorem ipsum dolor sit amet, ipsum labitur lucilius mei id, ad has appareat.Debut du paragraphe PDP oeuvre Lorem ipsum dolor sit amet, ipsum labitur lucilius mei id, ad has appareat.</p>

            <p>Debut du paragraphe PDP oeuvre Lorem ipsum dolor sit amet, ipsum labitur lucilius mei id, ad has appareat. Debut du paragraphe PDP oeuvre Lorem ipsum dolor sit amet, ipsum labitur lucilius mei id, ad has appareat.Debut du paragraphe PDP oeuvre Lorem ipsum dolor sit amet, ipsum labitur lucilius mei id, ad has appareat. Debut du paragraphe PDP.Debut du paragraphe PDP oeuvre Lorem ipsum dolor sit amet, ipsum labitur lucilius mei id, ad has appareat. Debut du paragraphe PDP oeuvre Lorem ipsum dolor sit amet, ipsum labitur lucilius mei id, ad has appareat.</p>
          </div>

          <div class="navigation-buttons">
            @if (primaryCategory$ | async; as category) {
              <button mat-stroked-button [routerLink]="['/artworks', category.slug]" class="nav-button">
                <mat-icon>arrow_back</mat-icon>
                {{ category.name.toUpperCase() }}
              </button>
            } @else {
              <!-- Bouton de fallback si pas de catégorie trouvée -->
              <button mat-stroked-button routerLink="/artworks" class="nav-button">
                <mat-icon>arrow_back</mat-icon>
                RETOUR
              </button>
            }
            <button mat-stroked-button routerLink="/artworks" class="nav-button">
              TOUTES LES OEUVRES
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>
}

<!-- Modal identique -->
@if (showImageModal()) {
  <div class="image-modal" (click)="closeImageModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      @if (artwork$ | async; as artwork) {
        <img
          [src]="artwork.imageUrls[modalImageIndex()]"
          [alt]="artwork.title"
          class="modal-image">

        <button class="modal-close" (click)="closeImageModal()">
          <mat-icon>close</mat-icon>
        </button>

        @if (artwork.imageUrls.length > 1) {
          <button class="modal-prev" (click)="previousModalImage()" [disabled]="modalImageIndex() === 0">
            <mat-icon>chevron_left</mat-icon>
          </button>
          <button class="modal-next" (click)="nextModalImage()" [disabled]="modalImageIndex() === artwork.imageUrls.length - 1">
            <mat-icon>chevron_right</mat-icon>
          </button>
        }
      }
    </div>
  </div>
}

@if (artwork$ | async; as artwork) {
  <section class="artwork-detail-section">
    <div class="container">
      <div class="artwork-content">
        <div class="artwork-gallery">
          <div class="main-image-container">
            @if (artwork.imageUrls && artwork.imageUrls.length > 1) {
              <button
                type="button"
                class="main-carousel-btn prev"
                (click)="previousImage(artwork.imageUrls.length)">
                <mat-icon>chevron_left</mat-icon>
              </button>
              <button
                type="button"
                class="main-carousel-btn next"
                (click)="nextImage(artwork.imageUrls.length)">
                <mat-icon>chevron_right</mat-icon>
              </button>
            }

            <div class="main-image">
              <img
                [src]="artwork.imageUrls && artwork.imageUrls.length > 0 ? artwork.imageUrls[selectedImageIndex()] : artwork.mainImageUrl"
                [alt]="artwork.title"
                class="main-artwork-image"
                (click)="openImageModal(selectedImageIndex())">
            </div>
          </div>

          @if (artwork.imageUrls && artwork.imageUrls.length > 1) {
            <div class="thumbnail-carousel">
              <div class="thumbnails-container" #thumbnailsContainer>
                @for (imageUrl of artwork.imageUrls; track $index) {
                  <div
                    class="thumbnail"
                    [class.active]="selectedImageIndex() === $index"
                    (click)="selectImage($index)">
                    <img [src]="imageUrl" [alt]="artwork.title">
                  </div>
                }
              </div>
            </div>
          }
        </div>

        <div class="artwork-info">
          <h3 class="artwork-title">{{ artwork.title }}</h3>

          <div class="artwork-description">
            <p>{{ artwork.description }}</p>
          </div>

          <div class="navigation-buttons">
            @if (primaryCategory$ | async; as category) {
              <button mat-stroked-button [routerLink]="['/artworks', category.slug]" class="nav-button">
                <mat-icon>arrow_back</mat-icon>
                {{ category.name.toUpperCase() }}
              </button>
            } @else {
              <button mat-stroked-button routerLink="/artworks" class="nav-button">
                <mat-icon>arrow_back</mat-icon>
                RETOUR
              </button>
            }
            <button mat-stroked-button routerLink="/artworks" class="nav-button">
              TOUTES LES Å’UVRES
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>
}

@if (showImageModal()) {
  <div class="image-modal" (click)="closeImageModal()">
    <div class="modal-content">
      @if (artwork$ | async; as artwork) {
        <div class="modal-image-wrapper">
          <img
            [src]="artwork.imageUrls[modalImageIndex()]"
            [alt]="artwork.title"
            class="modal-image"
            (click)="$event.stopPropagation()">

          <button type="button" class="modal-close" (click)="closeImageModal()">
            <mat-icon>close</mat-icon>
          </button>

          @if (artwork.imageUrls.length > 1) {
            <button
              type="button"
              class="modal-prev"
              (click)="previousModalImage($event, artwork.imageUrls.length)">
              <mat-icon>chevron_left</mat-icon>
            </button>
            <button
              type="button"
              class="modal-next"
              (click)="nextModalImage($event, artwork.imageUrls.length)">
              <mat-icon>chevron_right</mat-icon>
            </button>
          }
        </div>
      }
    </div>
  </div>
}

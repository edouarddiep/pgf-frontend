<div class="image-upload-container">
  <input
    type="file"
    #fileInput
    (change)="onFileSelected($event)"
    accept="image/*"
    class="file-input"
    [disabled]="uploading()">

  <div class="upload-area"
       (click)="fileInput.click()"
       (dragover)="onDragOver($event)"
       (dragleave)="onDragLeave($event)"
       (drop)="onDrop($event)"
       [class.dragging]="isDragging()"
       [class.uploading]="uploading()">

    @if (uploading()) {
      <div class="upload-progress">
        <mat-icon>cloud_upload</mat-icon>
        <p>Upload en cours...</p>
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
      </div>
    } @else if (previewUrl()) {
      <div class="image-preview">
        <img [src]="previewUrl()" alt="Preview">
        <div class="preview-overlay">
          <button mat-icon-button (click)="removeImage($event)">
            <mat-icon>delete</mat-icon>
          </button>
        </div>
      </div>
    } @else {
      <div class="upload-prompt">
        <mat-icon>add_photo_alternate</mat-icon>
        <p>Cliquez ou glissez une image ici</p>
        <small>Formats support√©s: JPG, PNG, GIF, WebP (max 10MB)</small>
      </div>
    }
  </div>

  @if (errorMessage()) {
    <div class="error-message">
      <mat-icon>error</mat-icon>
      <span>{{ errorMessage() }}</span>
    </div>
  }
</div>
